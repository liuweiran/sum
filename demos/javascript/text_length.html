<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>字符长度</title>
<script type="text/javascript" src="../../assets/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript">

$(function(){

    var txt = $('.div1').text();

    //方法一
    String.prototype.gblen = function() {
        var len = 0;
        for (var i=0; i<this.length; i++) {
            if (this.charCodeAt(i)>127 || this.charCodeAt(i)==94) {
                 len += 2;
             } else {
                 len ++;
             }
         }
        return len;
    };
    //var txt = new String("foo");
    //alert(txt.gblen());


    //方法二
    function strlen(str){
        var len = 0;
        for (var i=0; i<str.length; i++) {
         var c = str.charCodeAt(i);
        //单字节加1 双字节加2
         if ((c >= 0x0001 && c <= 0x007e) || (0xff60<=c && c<=0xff9f)) {
           len++;
         }
         else {
          len+=2;
         }
        }
        return len;
    }
    //alert(strlen(txt))


    //方法三
    var jmz = {};
    jmz.GetLength = function(str) {
        ///<summary>获得字符串实际长度，中文2，英文1</summary>
        ///<param name="str">要获得长度的字符串</param>
        var realLength = 0, len = str.length, charCode = -1;
        for (var i = 0; i < len; i++) {
            charCode = str.charCodeAt(i);
            if (charCode >= 0 && charCode <= 128) realLength += 1;
            else realLength += 2;
        }
        return realLength;
    };
    //alert(jmz.GetLength(txt))


    //方法四
    function gLen(str){
        var l = str.length;
        var blen = 0;
        for(i=0; i<l; i++) {
            if ((str.charCodeAt(i) & 0xff00) != 0) {
            blen ++;
            }
            blen ++;
        }
        return blen
    }
    //alert(gLen(txt))


    //方法五 把双字节的替换成两个单字节的然后再获得长度
    getBLen = function(str) {
        if (str == null) return 0;
        if (typeof str != "string"){
            str += "";
        }
        return str.replace(/[^\x00-\xff]/g,"01").length;
    };
    alert(getBLen(txt))

})

</script>
</head>

<body>
<div class="div1">这里有十六个字符</div>

</body>
</html>
